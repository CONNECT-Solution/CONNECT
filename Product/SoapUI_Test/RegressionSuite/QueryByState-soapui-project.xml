<?xml version="1.0" encoding="UTF-8" standalone="no"?><con:soapui-project xmlns:con="http://eviware.com/soapui/config" abortOnError="false" name="QueryByState" resourceRoot="" runType="SEQUENTIAL" soapui-version="3.6">
	<con:settings/>
	<con:interface xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" anonymous="optional" bindingName="{urn:gov:hhs:fha:nhinc:nhinccomponentconnectionmanager}NhincComponentConnectionManagerBindingSoap" definition="WSDL path not set.  #NhincComponentConnectionManager.wsdl" name="NhincComponentConnectionManagerBindingSoap" soapVersion="1_2" type="wsdl" wsaVersion="NONE" xsi:type="con:WsdlInterface">
		<con:settings/>
		
		<con:endpoints>
			<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
			<con:endpoint>http://localhost:${NhincHttpPort}/NhinConnect/NhincComponentConnectionManager</con:endpoint>
		</con:endpoints>
		<con:operation action="urn:ForceRefreshInternalConnectCache" anonymous="optional" bindingOperationName="ForceRefreshInternalConnectCache" inputName="ForceRefreshInternalConnectCacheRequest" isOneWay="false" name="ForceRefreshInternalConnectCache" outputName="ForceRefreshInternalConnectCacheResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response">
			<con:settings/>
			
		</con:operation>
		<con:operation action="urn:ForceRefreshUDDICache" anonymous="optional" bindingOperationName="ForceRefreshUDDICache" inputName="ForceRefreshUDDICacheRequest" isOneWay="false" name="ForceRefreshUDDICache" outputName="ForceRefreshUDDICacheResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response">
			<con:settings/>
			
		</con:operation>
		<con:operation action="urn:GetAllBusinessEntities" anonymous="optional" bindingOperationName="GetAllBusinessEntities" inputName="GetAllBusinessEntitiesRequest" isOneWay="false" name="GetAllBusinessEntities" outputName="GetAllBusinessEntitiesResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response">
			<con:settings/>
			
		</con:operation>
		<con:operation action="urn:GetAllBusinessEntitySetByServiceName" anonymous="optional" bindingOperationName="GetAllBusinessEntitySetByServiceName" inputName="GetAllBusinessEntitySetByServiceNameRequest" isOneWay="false" name="GetAllBusinessEntitySetByServiceName" outputName="GetAllBusinessEntitySetByServiceNameResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response">
			<con:settings/>
			
		</con:operation>
		
		
		
		<con:operation action="urn:GetAssigningAuthoritiesByHomeCommunity" anonymous="optional" bindingOperationName="GetAssigningAuthoritiesByHomeCommunity" inputName="GetAssigningAuthoritiesByHomeCommunityRequest" isOneWay="false" name="GetAssigningAuthoritiesByHomeCommunity" outputName="GetAssigningAuthoritiesByHomeCommunityResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response">
			<con:settings/>
			
		</con:operation>
		<con:operation action="urn:GetBusinessEntity" anonymous="optional" bindingOperationName="GetBusinessEntity" inputName="GetBusinessEntityRequest" isOneWay="false" name="GetBusinessEntity" outputName="GetBusinessEntityResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response">
			<con:settings/>
			
		</con:operation>
		<con:operation action="urn:GetBusinessEntityByServiceName" anonymous="optional" bindingOperationName="GetBusinessEntityByServiceName" inputName="GetBusinessEntityByServiceNameRequest" isOneWay="false" name="GetBusinessEntityByServiceName" outputName="GetBusinessEntityByServiceNameResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response">
			<con:settings/>
			
		</con:operation>
		<con:operation action="urn:GetBusinessEntitySet" anonymous="optional" bindingOperationName="GetBusinessEntitySet" inputName="GetBusinessEntitySetRequest" isOneWay="false" name="GetBusinessEntitySet" outputName="GetBusinessEntitySetResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response">
			<con:settings/>
			
		</con:operation>
		<con:operation action="urn:GetBusinessEntitySetByServiceName" anonymous="optional" bindingOperationName="GetBusinessEntitySetByServiceName" inputName="GetBusinessEntitySetByServiceNameRequest" isOneWay="false" name="GetBusinessEntitySetByServiceName" outputName="GetBusinessEntitySetByServiceNameResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response">
			<con:settings/>
			
		</con:operation>
		
		
		
		
		
		
		
		<con:operation action="urn:GetHomeCommunityByAssigningAuthority" anonymous="optional" bindingOperationName="GetHomeCommunityByAssigningAuthority" inputName="GetHomeCommunityByAssigningAuthorityRequest" isOneWay="false" name="GetHomeCommunityByAssigningAuthority" outputName="GetHomeCommunityByAssigningAuthorityResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response">
			<con:settings/>
			
		</con:operation>
		<con:operation action="urn:GetEndpointURLFromNhinTargetCommunities" anonymous="optional" bindingOperationName="GetEndpointURLFromNhinTargetCommunities" inputName="GetEndpointURLFromNhinTargetCommunitiesRequest" isOneWay="false" name="GetEndpointURLFromNhinTargetCommunities" outputName="GetEndpointURLFromNhinTargetCommunitiesResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response">
			<con:settings/>
			
		</con:operation>
		
	<con:operation action="urn:GetDefaultEndpointURLByServiceName" bindingOperationName="GetDefaultEndpointURLByServiceName" inputName="GetDefaultEndpointURLByServiceNameRequest" isOneWay="false" name="GetDefaultEndpointURLByServiceName" outputName="GetDefaultEndpointURLByServiceNameResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response"><con:settings/></con:operation><con:operation action="urn:GetInternalEndpointURLByServiceName" bindingOperationName="GetInternalEndpointURLByServiceName" inputName="GetInternalEndpointURLByServiceNameRequest" isOneWay="false" name="GetInternalEndpointURLByServiceName" outputName="GetInternalEndpointURLByServiceNameResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response"><con:settings/></con:operation><con:operation action="urn:GetEndpointURLFromNhinTarget" anonymous="optional" bindingOperationName="GetEndpointURLFromNhinTarget" inputName="GetEndpointURLFromNhinTargetRequest" isOneWay="false" name="GetEndpointURLFromNhinTarget" outputName="GetEndpointURLFromNhinTargetResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response"><con:settings/></con:operation><con:operation action="urn:GetAdapterEndpointURL" bindingOperationName="GetAdapterEndpointURL" inputName="GetAdapterEndpointURLRequest" isOneWay="false" name="GetAdapterEndpointURL" outputName="GetAdapterEndpointURLResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response"><con:settings/></con:operation></con:interface>
	<con:testSuite name="QueryByState TestSuite">
		<con:settings/>
		<con:runType>SEQUENTIAL</con:runType>
		<con:testCase failOnError="true" failTestCaseOnErrors="true" id="4f065352-c415-4633-977a-7620a6711b2f" keepSession="false" maxResults="0" name="UDDI file - by HCID" searchProperties="true">
			<con:settings/>
			
			<con:testStep name="copy internalConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalConnectionInfo.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
			<con:testStep name="copy uddiConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "QBS-uddiConnectionInfo.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "uddiConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
			<con:testStep name="Single HCID" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="Single HCID">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>4.4</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>QueryForDocuments</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						<con:assertion name="url match" type="XPath Match">
							<con:configuration><path>declare namespace ns6='urn:gov:hhs:fha:nhinc:common:nhinccommon';
declare namespace ns5='urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo';

//ns5:URLInfos[1]/ns6:url[1]</path><content>https://localhost:8181/RespondingGateway_Query_Service/DocQueryTestHelper4.4</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences></con:configuration>
						</con:assertion>
						<con:assertion type="XPath Match"><con:configuration><path>declare namespace ns6='urn:gov:hhs:fha:nhinc:common:nhinccommon';
declare namespace ns5='urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo';

//ns5:URLInfos[1]/ns6:id[1]</path><content>4.4</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences></con:configuration></con:assertion><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			<con:testStep name="Multiple HCIDs" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="Multiple HCIDs">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
	    <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>6.6</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>4.4</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>QueryForDocuments</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						
						
						<con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/RespondingGateway_Query_Service/DocQueryTestHelper6.6</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/RespondingGateway_Query_Service/DocQueryTestHelper4.4</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			<con:testStep name="Single HCID ( only in UDDI )" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="Single HCID ( only in UDDI )">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>6.6</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						<con:assertion type="XPath Match">
							<con:configuration><path>declare namespace ns6='urn:gov:hhs:fha:nhinc:common:nhinccommon';
declare namespace ns5='urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo';

//ns5:URLInfos[1]/ns6:url[1]</path><content>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery6.6</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences></con:configuration>
						</con:assertion>
						<con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			
			<con:setupScript>def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(sourceInternalFile, backupInternalFile, log);
MoveFile(sourceUddiFile, backupUddiFile, log);</con:setupScript><con:properties/>
			<con:reportParameters/>
			<con:tearDownScript>import nhinc.FileUtils;
FileUtils.restoreToMasterConfiguration(context, log);

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(backupInternalFile, sourceInternalFile, log);
MoveFile(backupUddiFile, sourceUddiFile, log);

void DeleteFile(File file, log) {  
   if(file.exists()) {    
      log.info("deleting file " + file);
      file.delete(); 
   } else {
      log.info("file not found, skipping delete for " + file);
   }
}

DeleteFile(backupInternalFile, log);
DeleteFile(backupUddiFile, log);</con:tearDownScript>
		</con:testCase>
		<con:testCase failOnError="true" failTestCaseOnErrors="true" id="630f6f5f-5fa8-4d99-a30c-2b39fd8391e2" keepSession="false" maxResults="0" name="UDDI file - by Region" searchProperties="true">
			<con:settings/>
			
			<con:testStep name="copy internalConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalConnectionInfo.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
			<con:testStep name="copy uddiConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "QBS-uddiConnectionInfo.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "uddiConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
			<con:testStep name="Single Region" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="Single Region">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						
						
						
						
						<con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery5.5</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery5.5</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			<con:testStep name="Multiple Regions" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="Multiple Regions">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope">
   <soap:Header/>
   <soap:Body projectName="QueryByState" testCase="UDDI file - by Region">
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-FL</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						
						
						
						
						
						<con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery6.6</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			<con:testStep name="Multiple Regions ( one from UDDI and one from ICI )" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="Multiple Regions ( one from UDDI and one from ICI )">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope">
   <soap:Header/>
   <soap:Body projectName="QueryByState" testCase="UDDI file - by Region">
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-AZ</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-FL</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						
						
						
						
						
						<con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery6.6</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			
			<con:setupScript>def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(sourceInternalFile, backupInternalFile, log);
MoveFile(sourceUddiFile, backupUddiFile, log);</con:setupScript><con:properties/>
			<con:reportParameters/>
			<con:tearDownScript>import nhinc.FileUtils;
FileUtils.restoreToMasterConfiguration(context, log);

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(backupInternalFile, sourceInternalFile, log);
MoveFile(backupUddiFile, sourceUddiFile, log);

void DeleteFile(File file, log) {  
   if(file.exists()) {    
      log.info("deleting file " + file);
      file.delete(); 
   } else {
      log.info("file not found, skipping delete for " + file);
   }
}

DeleteFile(backupInternalFile, log);
DeleteFile(backupUddiFile, log);</con:tearDownScript>
		</con:testCase>
		<con:testCase failOnError="true" failTestCaseOnErrors="true" id="f9a1e465-20a1-4f61-9e5a-69ab80df360c" keepSession="false" maxResults="0" name="UDDI file - by region + HCID in the same tag" searchProperties="true">
			<con:settings/>
			
			<con:testStep name="copy internalConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalConnectionInfo.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
			<con:testStep name="copy uddiConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "QBS-uddiConnectionInfo.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "uddiConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
			<con:testStep name="Region and associated HCID" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="Region and associated HCID">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>4.4</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						
						
						
						
						<con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			<con:testStep name="Region and non-associated HCID" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="Region and non-associated HCID">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>6.6</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						
						
						
						
						
						<con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			
			<con:setupScript>def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(sourceInternalFile, backupInternalFile, log);
MoveFile(sourceUddiFile, backupUddiFile, log);</con:setupScript><con:properties/>
			<con:reportParameters/>
			<con:tearDownScript>import nhinc.FileUtils;
FileUtils.restoreToMasterConfiguration(context, log);

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(backupInternalFile, sourceInternalFile, log);
MoveFile(backupUddiFile, sourceUddiFile, log);

void DeleteFile(File file, log) {  
   if(file.exists()) {    
      log.info("deleting file " + file);
      file.delete(); 
   } else {
      log.info("file not found, skipping delete for " + file);
   }
}

DeleteFile(backupInternalFile, log);
DeleteFile(backupUddiFile, log);</con:tearDownScript>
		</con:testCase>
		<con:testCase failOnError="true" failTestCaseOnErrors="true" id="73228566-f4f5-4da1-8a48-10314572f144" keepSession="false" maxResults="0" name="UDDI file - by region + HCID in a different tag" searchProperties="true">
			<con:settings/>
			
			<con:testStep name="copy internalConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalConnectionInfo.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
			<con:testStep name="copy uddiConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "QBS-uddiConnectionInfo.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "uddiConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
			<con:testStep name="Region and associating HCID" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="Region and associating HCID">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope">
   <soap:Header/>
   <soap:Body projectName="QueryByState" testCase="UDDI file - by Region">
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>4.4</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region></urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						
						
						
						
						<con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			<con:testStep name="Region and non-associated HCID" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="Region and non-associated HCID">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope">
   <soap:Header/>
   <soap:Body projectName="QueryByState" testCase="UDDI file - by Region">
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>6.6</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region></urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						
						
						
						
						
						<con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			
			<con:setupScript>def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(sourceInternalFile, backupInternalFile, log);
MoveFile(sourceUddiFile, backupUddiFile, log);</con:setupScript><con:properties/>
			<con:reportParameters/>
			<con:tearDownScript>import nhinc.FileUtils;
FileUtils.restoreToMasterConfiguration(context, log);

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(backupInternalFile, sourceInternalFile, log);
MoveFile(backupUddiFile, sourceUddiFile, log);

void DeleteFile(File file, log) {  
   if(file.exists()) {    
      log.info("deleting file " + file);
      file.delete(); 
   } else {
      log.info("file not found, skipping delete for " + file);
   }
}

DeleteFile(backupInternalFile, log);
DeleteFile(backupUddiFile, log);</con:tearDownScript>
		</con:testCase>
		<con:testCase failOnError="true" failTestCaseOnErrors="true" id="c09e77f8-1a65-4030-bf5d-c60b49af4fd0" keepSession="false" maxResults="0" name="InternalConnectionInfo file - by HCID" searchProperties="true">
			<con:settings/>
			
			<con:testStep name="copy internalConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalConnectionInfo.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
			<con:testStep name="copy uddiConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "QBS-uddiConnectionInfo.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "uddiConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
			<con:testStep name="Single HCID" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="Single HCID">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>1.1</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>?</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						
						<con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			<con:testStep name="Multiple HCIDs" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="Multiple HCIDs">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>4.4</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>?</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>8.8</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>?</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						
						
						<con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			
			<con:setupScript>def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(sourceInternalFile, backupInternalFile, log);
MoveFile(sourceUddiFile, backupUddiFile, log);</con:setupScript><con:properties/>
			<con:reportParameters/>
			<con:tearDownScript>import nhinc.FileUtils;
FileUtils.restoreToMasterConfiguration(context, log);

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(backupInternalFile, sourceInternalFile, log);
MoveFile(backupUddiFile, sourceUddiFile, log);

void DeleteFile(File file, log) {  
   if(file.exists()) {    
      log.info("deleting file " + file);
      file.delete(); 
   } else {
      log.info("file not found, skipping delete for " + file);
   }
}

DeleteFile(backupInternalFile, log);
DeleteFile(backupUddiFile, log);</con:tearDownScript>
		</con:testCase>
		<con:testCase failOnError="true" failTestCaseOnErrors="true" id="2e1a8cdd-95a9-42bb-a518-dce9c8aeb974" keepSession="false" maxResults="0" name="InternalConnectionInfo file - by Region" searchProperties="true">
			<con:settings/>
			
			<con:testStep name="copy internalConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalConnectionInfo.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
			<con:testStep name="copy uddiConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "QBS-uddiConnectionInfo.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "uddiConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
			<con:testStep name="Single Region" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="Single Region">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-MD</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						
						<con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			<con:testStep name="Multiple Regions" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="Multiple Regions">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-AZ</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-MD</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						
						
						
						
						<con:assertion type="Simple Contains"><con:configuration><token/><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			
			<con:setupScript>def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(sourceInternalFile, backupInternalFile, log);
MoveFile(sourceUddiFile, backupUddiFile, log);</con:setupScript><con:properties/>
			<con:reportParameters/>
			<con:tearDownScript>import nhinc.FileUtils;
FileUtils.restoreToMasterConfiguration(context, log);

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(backupInternalFile, sourceInternalFile, log);
MoveFile(backupUddiFile, sourceUddiFile, log);

void DeleteFile(File file, log) {  
   if(file.exists()) {    
      log.info("deleting file " + file);
      file.delete(); 
   } else {
      log.info("file not found, skipping delete for " + file);
   }
}

DeleteFile(backupInternalFile, log);
DeleteFile(backupUddiFile, log);</con:tearDownScript>
		</con:testCase>
		<con:testCase failOnError="true" failTestCaseOnErrors="true" id="6f71882a-7bce-4a7c-947e-9a0dfabdcbac" keepSession="false" maxResults="0" name="InternalConnectionInfo file - by Region + HCID in the same tag" searchProperties="true">
			<con:settings/>
			
			<con:testStep name="copy internalConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalConnectionInfo.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
			<con:testStep name="copy uddiConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "QBS-uddiConnectionInfo.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "uddiConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
			<con:testStep name="Region and associated HCID" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="Region and associated HCID">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>1.1</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						
						
						
						
						<con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			<con:testStep name="Region and non-associated HCID" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="Region and non-associated HCID">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>6.6</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						
						
						
						<con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery6.6</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery5.5</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			
			<con:setupScript>def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(sourceInternalFile, backupInternalFile, log);
MoveFile(sourceUddiFile, backupUddiFile, log);</con:setupScript><con:properties/>
			<con:reportParameters/>
			<con:tearDownScript>import nhinc.FileUtils;
FileUtils.restoreToMasterConfiguration(context, log);

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(backupInternalFile, sourceInternalFile, log);
MoveFile(backupUddiFile, sourceUddiFile, log);

void DeleteFile(File file, log) {  
   if(file.exists()) {    
      log.info("deleting file " + file);
      file.delete(); 
   } else {
      log.info("file not found, skipping delete for " + file);
   }
}

DeleteFile(backupInternalFile, log);
DeleteFile(backupUddiFile, log);</con:tearDownScript>
		</con:testCase>
		<con:testCase failOnError="true" failTestCaseOnErrors="true" id="23cf96e9-846d-4636-83ca-684ebd72771d" keepSession="false" maxResults="0" name="InternalConnectionInfo file - by Region + HCID in a different tag" searchProperties="true">
			<con:settings/>
			
			<con:testStep name="copy internalConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalConnectionInfo.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
			<con:testStep name="copy uddiConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "QBS-uddiConnectionInfo.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "uddiConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
			<con:testStep name="Region and associating HCID" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="Region and associating HCID">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>1.1</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>?</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-AZ</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						
						
						
						<con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			<con:testStep name="Region and non-associated HCID" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="Region and non-associated HCID">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>2.2</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>?</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-AZ</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						
						
						
						
						<con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			
			<con:setupScript>def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(sourceInternalFile, backupInternalFile, log);
MoveFile(sourceUddiFile, backupUddiFile, log);</con:setupScript><con:properties/>
			<con:reportParameters/>
			<con:tearDownScript>import nhinc.FileUtils;
FileUtils.restoreToMasterConfiguration(context, log);

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(backupInternalFile, sourceInternalFile, log);
MoveFile(backupUddiFile, sourceUddiFile, log);

void DeleteFile(File file, log) {  
   if(file.exists()) {    
      log.info("deleting file " + file);
      file.delete(); 
   } else {
      log.info("file not found, skipping delete for " + file);
   }
}

DeleteFile(backupInternalFile, log);
DeleteFile(backupUddiFile, log);</con:tearDownScript>
		</con:testCase>
		<con:testCase failOnError="true" failTestCaseOnErrors="true" id="93d90bd5-3049-4261-9981-f58ce4469271" keepSession="false" maxResults="0" name="ICI and UDDI" searchProperties="true">
			<con:settings/>
			
			<con:testStep name="copy internalConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalConnectionInfo.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
			<con:testStep name="copy uddiConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "QBS-uddiConnectionInfo.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "uddiConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
			<con:testStep name="Region in both UDDI anad ICI" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="Region in both UDDI anad ICI">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						
						
						
						
						<con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			<con:testStep name="HCID in both UDDI and ICI" type="request">
				<con:settings/>
				<con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
					<con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
					<con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
					<con:request name="HCID in both UDDI and ICI">
						<con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting></con:settings>
						<con:encoding>UTF-8</con:encoding>
						<con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
						<con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>4.4</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>?</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
						<con:assertion type="SOAP Response"/>
						<con:assertion type="SOAP Fault Assertion"/>
						
						<con:assertion type="Simple Contains"><con:configuration><token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/>
						<con:wsrmConfig version="1.2"/>
					</con:request>
				</con:config>
			</con:testStep>
			
			<con:setupScript>def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(sourceInternalFile, backupInternalFile, log);
MoveFile(sourceUddiFile, backupUddiFile, log);</con:setupScript><con:properties/>
			<con:reportParameters/>
			<con:tearDownScript>import nhinc.FileUtils;
FileUtils.restoreToMasterConfiguration(context, log);

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(backupInternalFile, sourceInternalFile, log);
MoveFile(backupUddiFile, sourceUddiFile, log);

void DeleteFile(File file, log) {  
   if(file.exists()) {    
      log.info("deleting file " + file);
      file.delete(); 
   } else {
      log.info("file not found, skipping delete for " + file);
   }
}

DeleteFile(backupInternalFile, log);
DeleteFile(backupUddiFile, log);</con:tearDownScript>
		</con:testCase>
		<con:properties/>
		<con:reportParameters/>
	</con:testSuite>
	<con:requirements/>
	<con:properties>
		<con:property>
			<con:name>DBPass</con:name>
			<con:value>nhincpass</con:value>
		</con:property>
		<con:property>
			<con:name>DBHost</con:name>
			<con:value>localhost</con:value>
		</con:property>
		<con:property>
			<con:name>Endpoint-Querybystate</con:name>
			<con:value>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:value>
		</con:property>
		<con:property>
			<con:name>LocalConfigDir</con:name>
			<con:value>C:/SelfTest/EndToEndSelfTest</con:value>
		</con:property>
		<con:property>
			<con:name>DBUser</con:name>
			<con:value>nhincuser</con:value>
		</con:property>
		<con:property>
			<con:name>DBPort</con:name>
			<con:value>3306</con:value>
		</con:property>
		<con:property>
			<con:name>MPIDir</con:name>
			<con:value>C:/Sun/AppServer/domains/domain1/config</con:value>
		</con:property>
		<con:property>
			<con:name>NHINGatewayConfigDir</con:name>
			<con:value>C:/Sun/AppServer/domains/domain1/config/nhin</con:value>
		</con:property>
	</con:properties>
	<con:afterLoadScript>def propertiesFile = new File(new File(project.path).parent, 'QueryByState-soapui-project.properties')
if (propertiesFile.exists()) {
	def props = new Properties()
	props.load(new FileReader(propertiesFile))
	props.each { key, value -&gt;
	    project.setPropertyValue(key, value)
	}
}

com.eviware.soapui.impl.wsdl.testcase.WsdlTestRunContext.metaClass.findProperty = { propertyName -&gt;
return delegate.getProperty(propertyName) ?:
delegate.testCase.getPropertyValue(propertyName) ?:
delegate.testCase.testSuite.getPropertyValue(propertyName) ?:
delegate.testCase.testSuite.project.getPropertyValue(propertyName)
}</con:afterLoadScript>
	<con:wssContainer/>
	<con:databaseConnectionContainer/>
	<con:reporting>
		<con:reportTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:xmlTemplates/>
		<con:parameters/>
	</con:reporting>
	<con:eventHandlers name="TestSuiteRunListener.beforeTestCase" type="TestSuiteRunListener.beforeTestCase">
		<con:script>FileUtils.backupConfiguration(context, log);</con:script>
	</con:eventHandlers>
	<con:eventHandlers name="TestSuiteRunListener.afterTestCase" type="TestSuiteRunListener.afterTestCase">
		<con:script>FileUtils.restoreConfiguration(context, log)</con:script>
	</con:eventHandlers>
</con:soapui-project>