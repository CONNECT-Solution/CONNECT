<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project abortOnError="false" name="QueryByState" resourceRoot="${projectDir}" runType="SEQUENTIAL" soapui-version="5.1.2" activeEnvironment="Default" id="796cf76d-9f77-40b2-9717-f7d83a62a860" xmlns:con="http://eviware.com/soapui/config">
  <con:settings/>
  <con:interface anonymous="optional" bindingName="{urn:gov:hhs:fha:nhinc:nhinccomponentconnectionmanager}NhincComponentConnectionManagerBindingSoap" definition="../../../target/wsdl/NhincComponentConnectionManager.wsdl" name="NhincComponentConnectionManagerBindingSoap" soapVersion="1_2" type="wsdl" wsaVersion="NONE" xsi:type="con:WsdlInterface" id="6f7d3e26-d683-4571-8cc3-64bb95d45671" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:endpoints>
      <con:endpoint>http://localhost:${NhincHttpPort}/NhinConnect/NhincComponentConnectionManager</con:endpoint>
      <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
    </con:endpoints>
    <con:operation action="urn:ForceRefreshInternalConnectCache" anonymous="optional" bindingOperationName="ForceRefreshInternalConnectCache" inputName="ForceRefreshInternalConnectCacheRequest" isOneWay="false" name="ForceRefreshInternalConnectCache" outputName="ForceRefreshInternalConnectCacheResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response" id="c17a9503-2c38-4f28-b2f8-0ddd22d48089">
      <con:settings/>
    </con:operation>
    <con:operation action="urn:ForceRefreshUDDICache" anonymous="optional" bindingOperationName="ForceRefreshUDDICache" inputName="ForceRefreshUDDICacheRequest" isOneWay="false" name="ForceRefreshUDDICache" outputName="ForceRefreshUDDICacheResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response" id="29d53c12-25e4-4571-b93f-ebf3336af262">
      <con:settings/>
    </con:operation>
    <con:operation action="urn:GetAllBusinessEntities" anonymous="optional" bindingOperationName="GetAllBusinessEntities" inputName="GetAllBusinessEntitiesRequest" isOneWay="false" name="GetAllBusinessEntities" outputName="GetAllBusinessEntitiesResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response" id="5490d54b-3d92-4851-999f-6776e84ecf75">
      <con:settings/>
    </con:operation>
    <con:operation action="urn:GetAllBusinessEntitySetByServiceName" anonymous="optional" bindingOperationName="GetAllBusinessEntitySetByServiceName" inputName="GetAllBusinessEntitySetByServiceNameRequest" isOneWay="false" name="GetAllBusinessEntitySetByServiceName" outputName="GetAllBusinessEntitySetByServiceNameResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response" id="db21cc71-9e62-4b8c-b74a-ad0f49bf8ceb">
      <con:settings/>
    </con:operation>
    <con:operation action="urn:GetAssigningAuthoritiesByHomeCommunity" anonymous="optional" bindingOperationName="GetAssigningAuthoritiesByHomeCommunity" inputName="GetAssigningAuthoritiesByHomeCommunityRequest" isOneWay="false" name="GetAssigningAuthoritiesByHomeCommunity" outputName="GetAssigningAuthoritiesByHomeCommunityResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response" id="f60a697e-7ad2-48e1-bdbd-bd50ded1496f">
      <con:settings/>
    </con:operation>
    <con:operation action="urn:GetBusinessEntity" anonymous="optional" bindingOperationName="GetBusinessEntity" inputName="GetBusinessEntityRequest" isOneWay="false" name="GetBusinessEntity" outputName="GetBusinessEntityResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response" id="3583c70c-f849-4aca-b8ec-db8608133b91">
      <con:settings/>
    </con:operation>
    <con:operation action="urn:GetBusinessEntityByServiceName" anonymous="optional" bindingOperationName="GetBusinessEntityByServiceName" inputName="GetBusinessEntityByServiceNameRequest" isOneWay="false" name="GetBusinessEntityByServiceName" outputName="GetBusinessEntityByServiceNameResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response" id="554e5a43-27aa-496b-a290-a4962ae22c69">
      <con:settings/>
    </con:operation>
    <con:operation action="urn:GetBusinessEntitySet" anonymous="optional" bindingOperationName="GetBusinessEntitySet" inputName="GetBusinessEntitySetRequest" isOneWay="false" name="GetBusinessEntitySet" outputName="GetBusinessEntitySetResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response" id="438fa031-5d32-4f84-aa7f-4c5b5ba0bd09">
      <con:settings/>
    </con:operation>
    <con:operation action="urn:GetBusinessEntitySetByServiceName" anonymous="optional" bindingOperationName="GetBusinessEntitySetByServiceName" inputName="GetBusinessEntitySetByServiceNameRequest" isOneWay="false" name="GetBusinessEntitySetByServiceName" outputName="GetBusinessEntitySetByServiceNameResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response" id="9d3aafa8-6895-41db-81ac-df1f23234042">
      <con:settings/>
    </con:operation>
    <con:operation action="urn:GetHomeCommunityByAssigningAuthority" anonymous="optional" bindingOperationName="GetHomeCommunityByAssigningAuthority" inputName="GetHomeCommunityByAssigningAuthorityRequest" isOneWay="false" name="GetHomeCommunityByAssigningAuthority" outputName="GetHomeCommunityByAssigningAuthorityResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response" id="56867e27-30a1-483c-8fc3-92acaa60a1a4">
      <con:settings/>
    </con:operation>
    <con:operation action="urn:GetEndpointURLFromNhinTargetCommunities" anonymous="optional" bindingOperationName="GetEndpointURLFromNhinTargetCommunities" inputName="GetEndpointURLFromNhinTargetCommunitiesRequest" isOneWay="false" name="GetEndpointURLFromNhinTargetCommunities" outputName="GetEndpointURLFromNhinTargetCommunitiesResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response" id="0bb0e053-084c-4937-ada1-82b92b185f9d">
      <con:settings/>
    </con:operation>
    <con:operation action="urn:GetDefaultEndpointURLByServiceName" bindingOperationName="GetDefaultEndpointURLByServiceName" inputName="GetDefaultEndpointURLByServiceNameRequest" isOneWay="false" name="GetDefaultEndpointURLByServiceName" outputName="GetDefaultEndpointURLByServiceNameResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response" id="b0e516bd-6225-4a21-bfd3-5b30409c13b7">
      <con:settings/>
    </con:operation>
    <con:operation action="urn:GetInternalEndpointURLByServiceName" bindingOperationName="GetInternalEndpointURLByServiceName" inputName="GetInternalEndpointURLByServiceNameRequest" isOneWay="false" name="GetInternalEndpointURLByServiceName" outputName="GetInternalEndpointURLByServiceNameResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response" id="78ccafc6-eae3-4cf0-bcc1-fd6fcc34af5b">
      <con:settings/>
    </con:operation>
    <con:operation action="urn:GetEndpointURLFromNhinTarget" anonymous="optional" bindingOperationName="GetEndpointURLFromNhinTarget" inputName="GetEndpointURLFromNhinTargetRequest" isOneWay="false" name="GetEndpointURLFromNhinTarget" outputName="GetEndpointURLFromNhinTargetResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response" id="fc07f26a-ca5b-4851-ad5f-4864339b0d6b">
      <con:settings/>
    </con:operation>
    <con:operation action="urn:GetAdapterEndpointURL" bindingOperationName="GetAdapterEndpointURL" inputName="GetAdapterEndpointURLRequest" isOneWay="false" name="GetAdapterEndpointURL" outputName="GetAdapterEndpointURLResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response" id="d82ad651-8b38-43d3-9870-ae40ea5cb767">
      <con:settings/>
    </con:operation>
  </con:interface>
  <con:testSuite name="QueryByState TestSuite" id="65c7b6a1-6eb5-443d-99dc-f09ea83932d2">
    <con:settings/>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase failOnError="true" failTestCaseOnErrors="true" id="4f065352-c415-4633-977a-7620a6711b2f" keepSession="false" maxResults="0" name="UDDI file - by HCID" searchProperties="true">
      <con:settings/>
      <con:testStep name="copy internalExchangeInfo" type="groovy" id="06de1303-0c10-4b2d-8329-788c9a2dd19c">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalExchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalExchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="copy exchangeInfo" type="groovy" id="73509943-f973-4194-a546-987ac94728ac">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-exchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "exchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="Single HCID" type="request" id="178a4b77-a383-4068-ac28-056dde49d224">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Single HCID" id="9f33ff51-7c23-4aae-bf79-b49ef672e88d">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>4.4</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>QueryForDocuments</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="2fcdd331-2d7c-4243-bac0-2bd04a97f2cb"/>
            <con:assertion type="SOAP Fault Assertion" id="3c21c66f-20cc-4ce8-b482-aff4f6828298"/>
            <con:assertion name="url match" type="XPath Match" id="74e14edc-aa34-43de-90d3-43ec204d3bfa">
              <con:configuration>
                <path>declare namespace ns6='urn:gov:hhs:fha:nhinc:common:nhinccommon';
declare namespace ns5='urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo';

//ns5:URLInfos[1]/ns6:url[1]</path>
                <content>https://localhost:8181/RespondingGateway_Query_Service/DocQueryTestHelper4.4</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:assertion type="XPath Match" id="82b59d5c-4a85-493c-8c69-49eb37a9499c">
              <con:configuration>
                <path>declare namespace ns6='urn:gov:hhs:fha:nhinc:common:nhinccommon';
declare namespace ns5='urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo';

//ns5:URLInfos[1]/ns6:id[1]</path>
                <content>4.4</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Multiple HCIDs" type="request" id="34a737e1-b548-451a-952a-2dfe9b39b440">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Multiple HCIDs" id="00669277-5695-4a19-9f1a-3f2b603c431b">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
	    <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>6.6</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>4.4</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>QueryForDocuments</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="3214d2d5-fd46-4edd-a474-0e23ff12eac3"/>
            <con:assertion type="SOAP Fault Assertion" id="09c58a2b-7e29-46dc-9d15-6297be9407e6"/>
            <con:assertion type="Simple Contains" id="f4ac676e-c7e8-4e89-aae0-5b0050238c54">
              <con:configuration>
                <token>https://localhost:8181/RespondingGateway_Query_Service/DocQueryTestHelper6.6</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="9d55fdd4-06be-4ec9-bcfc-dc58be1a6d15">
              <con:configuration>
                <token>https://localhost:8181/RespondingGateway_Query_Service/DocQueryTestHelper4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Single HCID ( only in UDDI )" type="request" id="b754cee4-27ab-41ca-88d1-369d06dd24d1">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Single HCID ( only in UDDI )" id="3791ee74-b52d-46fb-a19d-b76da69b43f8">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>6.6</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="9949a491-0899-41a9-b95a-d6965907bd02"/>
            <con:assertion type="SOAP Fault Assertion" id="e4666f0f-5f8d-4509-b799-cb183bfb2e92"/>
            <con:assertion type="XPath Match" id="12cb2021-4a83-4ffa-a2f7-73128a72c84c">
              <con:configuration>
                <path>declare namespace ns6='urn:gov:hhs:fha:nhinc:common:nhinccommon';
declare namespace ns5='urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo';

//ns5:URLInfos[1]/ns6:url[1]</path>
                <content>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery6.6</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:setupScript>nhinc.FileUtils.backupConfiguration(context.findProperty("GatewayPropDir"), log);</con:setupScript>
      <con:properties/>
      <con:reportParameters/>
      <con:tearDownScript>nhinc.FileUtils.restoreConfiguration(context.findProperty("GatewayPropDir"), log);</con:tearDownScript>
    </con:testCase>
    <con:testCase failOnError="true" failTestCaseOnErrors="true" id="630f6f5f-5fa8-4d99-a30c-2b39fd8391e2" keepSession="false" maxResults="0" name="UDDI file - by Region" searchProperties="true">
      <con:settings/>
      <con:testStep name="copy internalExchangeInfo" type="groovy" id="eae8a9da-0cbb-4563-8989-96a925fc13ef">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalExchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalExchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="copy exchangeInfo" type="groovy" id="cec9737e-b0a3-437b-810f-c28b0842c5e2">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-exchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "exchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="Single Region" type="request" id="8ae8325c-183f-4488-9286-4b00ab8d6307">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Single Region" id="9a2e5316-d376-4e8b-8fb9-c6be0afea962">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="b30ee45f-d0d3-4b99-ab48-ccc49a05dfef"/>
            <con:assertion type="SOAP Fault Assertion" id="9a8abcb0-71c7-4b89-9d2d-1f1d68df3d70"/>
            <con:assertion type="Simple Contains" id="c23c8d8e-f448-4240-8ff3-6f365c1ffa79">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery5.5</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="f06ba7f7-973e-4ecb-b290-26dba1e5b22e">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery5.5</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="717894e3-4bd1-44e9-adb0-583cd3600fea">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="974a9c9d-31b6-44b5-934c-85e279a86c60">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Multiple Regions" type="request" id="00fc784d-9815-4f45-ad46-2ffda2f698b2">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Multiple Regions" id="51d7eb64-4f95-410f-95c4-ed43b1e30cd1">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope">
   <soap:Header/>
   <soap:Body projectName="QueryByState" testCase="UDDI file - by Region">
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-FL</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="c383265e-9fcd-4bc3-b197-cf013d14f761"/>
            <con:assertion type="SOAP Fault Assertion" id="ddef76ca-f63e-4f26-a1cc-5df91270754a"/>
            <con:assertion type="Simple Contains" id="e2e6289e-5a91-4ebf-bce8-0fe02dfbcf70">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="9456445f-39b8-41d4-b56c-9f31dc467cc7">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="7c6ec3e3-4c69-40f1-90ef-753ace442513">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="8014d536-6f38-4259-9326-d6f5e7172b6e">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="421a2b44-9dab-4c9a-8943-5e67ea88b02c">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery6.6</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Multiple Regions ( one from UDDI and one from ICI )" type="request" id="61fd7350-81ed-4782-a7d4-fe4654022893">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Multiple Regions ( one from UDDI and one from ICI )" id="3c8ff55c-623c-4021-8d4c-c106d72d54b0">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope">
   <soap:Header/>
   <soap:Body projectName="QueryByState" testCase="UDDI file - by Region">
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-AZ</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-FL</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="845eefd3-d022-4714-a68d-be3b3654520f"/>
            <con:assertion type="SOAP Fault Assertion" id="eada1b46-2c43-4dab-83b4-37b6394870af"/>
            <con:assertion type="Simple Contains" id="2ea01636-0cd6-4279-954d-28782bedd59f">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="9cc0b613-a3dd-44d0-83c3-df67cc102a82">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery6.6</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="81dd5328-60de-4456-baa7-c3e21602960e">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="cf2faf51-1142-4599-81d6-58eafb09764b">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="8d2cd7c8-a51c-45c4-af59-70884b1037d9">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:setupScript>nhinc.FileUtils.backupConfiguration(context.findProperty("GatewayPropDir"), log);</con:setupScript>
      <con:properties/>
      <con:reportParameters/>
      <con:tearDownScript>nhinc.FileUtils.restoreConfiguration(context.findProperty("GatewayPropDir"), log);</con:tearDownScript>
    </con:testCase>
    <con:testCase failOnError="true" failTestCaseOnErrors="true" id="f9a1e465-20a1-4f61-9e5a-69ab80df360c" keepSession="false" maxResults="0" name="UDDI file - by region + HCID in the same tag" searchProperties="true">
      <con:settings/>
      <con:testStep name="copy internalExchangeInfo" type="groovy" id="d9b118ed-33e8-4b18-a278-faf451c12baa">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalExchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalExchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="copy exchangeInfo" type="groovy" id="2177eae0-a043-40d3-9364-2816300524bc">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-exchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "exchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="Region and associated HCID" type="request" id="e4c45ad3-1c85-42b2-bd53-6ea2fc3eddbe">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Region and associated HCID" id="b574ce88-5dfc-422f-bd9d-f7cf05a04557">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>4.4</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="273a5720-d70a-4ef0-a736-1a9305f4444d"/>
            <con:assertion type="SOAP Fault Assertion" id="958dc000-0984-4ef8-b929-8151b209b769"/>
            <con:assertion type="Simple Contains" id="9721dd2f-de94-4a0e-9370-6bf454969d1a">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="d839579a-217f-4595-9294-edb6df3e0619">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="51b5eaed-4a17-4bff-a930-f2236da7d2eb">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="4604deef-6da2-40c6-9d48-507ec58b64cf">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Region and non-associated HCID" type="request" id="21a62876-5b36-4fdf-9ad3-0a6a049a982b">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Region and non-associated HCID" id="1f522d3f-8a4b-477f-8706-37a122ff7531">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>6.6</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="b61c3998-a88f-4228-aed8-519314700440"/>
            <con:assertion type="SOAP Fault Assertion" id="175f5d37-a62c-469f-9b1e-028a05c9323a"/>
            <con:assertion type="Simple Contains" id="fe211341-4ee8-4668-bf01-02bcb0e1c745">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="5dd038b8-873f-499d-af24-ddcacaf22040">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="6bc83af6-4b39-40f9-b918-375fffa0c6e1">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="74500dc0-3d43-4bee-9a2a-981271b4cebe">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:setupScript>nhinc.FileUtils.backupConfiguration(context.findProperty("GatewayPropDir"), log);</con:setupScript>
      <con:properties/>
      <con:reportParameters/>
      <con:tearDownScript>nhinc.FileUtils.restoreConfiguration(context.findProperty("GatewayPropDir"), log);</con:tearDownScript>
    </con:testCase>
    <con:testCase failOnError="true" failTestCaseOnErrors="true" id="73228566-f4f5-4da1-8a48-10314572f144" keepSession="false" maxResults="0" name="UDDI file - by region + HCID in a different tag" searchProperties="true">
      <con:settings/>
      <con:testStep name="copy internalExchangeInfo" type="groovy" id="f77bce62-1720-4c8f-b8f3-d7adf02f3f13">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalExchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalExchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="copy exchangeInfo" type="groovy" id="59da69e0-20d3-4ab3-887c-da2b5a1106f9">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-exchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "exchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="Region and associating HCID" type="request" id="4d8ddde8-4150-45d4-a4ee-7953ef7bb59b">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Region and associating HCID" id="ed8cc9eb-f214-4601-882c-fb201152f094">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope">
   <soap:Header/>
   <soap:Body projectName="QueryByState" testCase="UDDI file - by Region">
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>4.4</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region></urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="44d36561-3532-4a3e-a40d-63b624900f23"/>
            <con:assertion type="SOAP Fault Assertion" id="b89112e8-8ac5-4e73-87f1-82640ef5bb5f"/>
            <con:assertion type="Simple Contains" id="e6c674db-cd5c-46b6-93c6-75790d7d8e2b">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="7db572d4-98da-4167-b192-ae89d125cb2f">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="d0e2a003-ae75-47db-812d-f637eec3dd1c">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="92d41556-60db-4f18-9283-be06de3fad11">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Region and non-associated HCID" type="request" id="31856ea7-2ca4-4413-95f9-51625ea52098">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Region and non-associated HCID" id="7c57cc6b-0f12-4bb8-88c8-bc29f48f69db">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope">
   <soap:Header/>
   <soap:Body projectName="QueryByState" testCase="UDDI file - by Region">
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>6.6</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region></urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="c3f1c3b9-97b5-4538-8143-580f7f0b7043"/>
            <con:assertion type="SOAP Fault Assertion" id="462f016e-761a-4114-a469-4c581791cb6b"/>
            <con:assertion type="Simple Contains" id="045f99b6-5ee9-4fc3-abf6-1587a0d4ce02">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="4548d05b-5ed2-42d3-9137-9d38aedd0f88">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="f1d6760d-f4d2-4704-ba88-e4537ec2a6cf">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="11943aad-cd53-44b3-b951-3bbda9736693">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:setupScript>nhinc.FileUtils.backupConfiguration(context.findProperty("GatewayPropDir"), log);</con:setupScript>
      <con:properties/>
      <con:reportParameters/>
      <con:tearDownScript>nhinc.FileUtils.restoreConfiguration(context.findProperty("GatewayPropDir"), log);</con:tearDownScript>
    </con:testCase>
    <con:testCase failOnError="true" failTestCaseOnErrors="true" id="c09e77f8-1a65-4030-bf5d-c60b49af4fd0" keepSession="false" maxResults="0" name="internalExchangeInfo file - by HCID" searchProperties="true">
      <con:settings/>
      <con:testStep name="copy internalExchangeInfo" type="groovy" id="02ed7566-8ef8-4e36-b5e1-89cd45a0ba2e">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalExchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalExchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="copy exchangeInfo" type="groovy" id="2f6876ef-7243-4fc5-9d33-dd6abf66160a">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-exchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "exchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="Single HCID" type="request" id="063ce365-317c-4b1d-b5a1-15e58d4db474">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Single HCID" id="bf5157ba-f36c-447a-a5cd-e1ed523062f1">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>1.1</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>?</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="f0732005-9889-4de9-9fb5-c81e2ebd3ace"/>
            <con:assertion type="SOAP Fault Assertion" id="0575ab05-198b-4f9e-9e39-5eca0fa49331"/>
            <con:assertion type="Simple Contains" id="4d98bb2c-0eb0-4db3-9a1a-173a45d6dd33">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Multiple HCIDs" type="request" id="dfb6803d-e48c-4249-bed7-f01114c339f6">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Multiple HCIDs" id="6ec2d851-78e7-478b-aa76-77269ca17038">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>4.4</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>?</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>8.8</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>?</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="6e99d800-e559-467d-b978-817c2019b883"/>
            <con:assertion type="SOAP Fault Assertion" id="7586cdb3-d1ab-4011-b8c8-37e89bdeda22"/>
            <con:assertion type="Simple Contains" id="4df746f0-0c75-4487-bd61-ccdf774a9a99">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="fa5b0d86-d38d-4023-85c8-86e6b2e7c6f5">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:setupScript>nhinc.FileUtils.backupConfiguration(context.findProperty("GatewayPropDir"), log);</con:setupScript>
      <con:properties/>
      <con:reportParameters/>
      <con:tearDownScript>nhinc.FileUtils.restoreConfiguration(context.findProperty("GatewayPropDir"), log);</con:tearDownScript>
    </con:testCase>
    <con:testCase failOnError="true" failTestCaseOnErrors="true" id="2e1a8cdd-95a9-42bb-a518-dce9c8aeb974" keepSession="false" maxResults="0" name="internalExchangeInfo file - by Region" searchProperties="true">
      <con:settings/>
      <con:testStep name="copy internalExchangeInfo" type="groovy" id="7bd6dab7-9de9-477b-b839-4e7177430576">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalExchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalExchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="copy exchangeInfo" type="groovy" id="98153c51-556f-4b73-b034-df0760ba2d68">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-exchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "exchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="Single Region" type="request" id="93df54c3-dc9c-4ebe-b2c4-4da3d4ad59ec">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Single Region" id="5592ed56-bced-4db0-abf9-bcdd1023bf0e">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-MD</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="1e3c431e-9b6f-41b7-9156-6c9e75901e0d"/>
            <con:assertion type="SOAP Fault Assertion" id="01d5a627-089c-4b9c-958a-2c49e160b6e2"/>
            <con:assertion type="Simple Contains" id="0cc88a40-9175-4f39-8d38-8d857588e1bd">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Multiple Regions" type="request" id="78d23793-1898-41b5-8585-7586b2129378">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Multiple Regions" id="0b5b7821-b5ce-4d08-82c9-7b6ad555b1c1">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-AZ</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-MD</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="64b86104-2fcc-4cc6-a2d8-d8f9263f0a08"/>
            <con:assertion type="SOAP Fault Assertion" id="a4becded-fa6e-49f6-8997-f6523da0326d"/>
            <con:assertion type="Simple Contains" id="710614a8-36f3-457e-8b14-945d80b2783a">
              <con:configuration>
                <token/>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="470413a4-d5e8-4d24-82e5-3616dd0a9733">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="1da5f904-e7c3-43dd-b098-56c431e86571">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="8d11fd92-f63f-4639-bb48-599bf600fe58">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:setupScript>nhinc.FileUtils.backupConfiguration(context.findProperty("GatewayPropDir"), log);</con:setupScript>
      <con:properties/>
      <con:reportParameters/>
      <con:tearDownScript>nhinc.FileUtils.restoreConfiguration(context.findProperty("GatewayPropDir"), log);</con:tearDownScript>
    </con:testCase>
    <con:testCase failOnError="true" failTestCaseOnErrors="true" id="6f71882a-7bce-4a7c-947e-9a0dfabdcbac" keepSession="false" maxResults="0" name="internalExchangeInfo file - by Region + HCID in the same tag" searchProperties="true">
      <con:settings/>
      <con:testStep name="copy internalExchangeInfo" type="groovy" id="bd23ea93-d4cb-48a0-a016-6be66da5b4a1">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalExchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalExchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="copy exchangeInfo" type="groovy" id="ec909312-3559-49e2-a666-99bf0fdc3e3a">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-exchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "exchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="Region and associated HCID" type="request" id="d079d629-b552-4883-8a9c-0d48369b35c1">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Region and associated HCID" id="445c4255-3a79-4fe6-8843-580cbde91987">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>1.1</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="d8671abf-efd8-4d81-89ae-5dd6f7a6e0d8"/>
            <con:assertion type="SOAP Fault Assertion" id="e6159ab6-eba0-46c8-9de6-7c3436e9312f"/>
            <con:assertion type="Simple Contains" id="eff3ea66-8d86-4b95-b0ca-61fc02395cdb">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="f3ea6b8d-2499-49cf-b256-9b840509778c">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="f5dc4acc-2936-4125-90d9-a2af3ea82890">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="dc6a6334-0f04-4d36-889e-be2514607cf9">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Region and non-associated HCID" type="request" id="1feef9b8-a482-41a4-be47-f382dd9e35ed">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Region and non-associated HCID" id="400c0a85-6d53-498c-9868-794096b37d6e">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>6.6</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="cfb4ee4e-46e4-43f6-8eb3-9da6a3af8e97"/>
            <con:assertion type="SOAP Fault Assertion" id="2526495b-3349-49f5-8348-3542c30218f2"/>
            <con:assertion type="Simple Contains" id="6d434022-4914-43fb-8555-b5d54d1e020f">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery6.6</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="c50a6df4-c00f-4b06-96d5-cd2b5fd20ae6">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="e9910bd5-8bab-42db-b1c2-a5fee678eefd">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="5d124403-5cf3-400f-a5a7-50df458dd26c">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="11f70c5e-f999-4cd0-8fbc-44c9479a7d45">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery5.5</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="bf7f7221-62fd-4d75-8e1c-b74037bdfbcd">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:setupScript>nhinc.FileUtils.backupConfiguration(context.findProperty("GatewayPropDir"), log);</con:setupScript>
      <con:properties/>
      <con:reportParameters/>
      <con:tearDownScript>nhinc.FileUtils.restoreConfiguration(context.findProperty("GatewayPropDir"), log);</con:tearDownScript>
    </con:testCase>
    <con:testCase failOnError="true" failTestCaseOnErrors="true" id="23cf96e9-846d-4636-83ca-684ebd72771d" keepSession="false" maxResults="0" name="internalExchangeInfo file - by Region + HCID in a different tag" searchProperties="true">
      <con:settings/>
      <con:testStep name="copy internalExchangeInfo" type="groovy" id="05fdb399-cded-4719-9825-3bcca59d180d">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalExchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalExchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="copy exchangeInfo" type="groovy" id="f9b2efcc-d845-40c2-a62a-0e33d906ca47">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-exchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "exchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="Region and associating HCID" type="request" id="79bb77b0-590b-430d-bfda-dc450b74e7e1">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Region and associating HCID" id="82256e48-f821-4d65-b005-e2421db56275">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>1.1</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>?</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-AZ</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="f55e5ff9-c078-4482-a8a9-7bdd6d80554e"/>
            <con:assertion type="SOAP Fault Assertion" id="4793d1ef-77e8-41cf-ba1c-419542022038"/>
            <con:assertion type="Simple Contains" id="4f893d8e-b1c6-4408-99c0-d6339c728298">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="eb1ee356-f7a7-4ce9-a867-ad7979ded8b8">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="d5610abb-8e52-411a-8b01-d501dc9458dc">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Region and non-associated HCID" type="request" id="b0d086ce-9a31-457e-85f2-93a08fbbf188">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Region and non-associated HCID" id="f8a49738-35f4-4ac1-8ecf-69f0b2fb3efc">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>2.2</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>?</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-AZ</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="aac4cb83-80cf-47af-b7a5-56406486194d"/>
            <con:assertion type="SOAP Fault Assertion" id="dedc83c1-c63c-4848-9e70-7fb5a331da0f"/>
            <con:assertion type="Simple Contains" id="68f4528d-e6b7-483c-a30e-b81b08ab3ed5">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="75cf8f3b-380b-4db8-9b31-5af3b2c3b21a">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="70c5470e-2a51-43ec-8f9b-cd602d24e016">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="eec8933e-9a11-4c4e-9081-c3d5661e92c9">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:setupScript>nhinc.FileUtils.backupConfiguration(context.findProperty("GatewayPropDir"), log);</con:setupScript>
      <con:properties/>
      <con:reportParameters/>
      <con:tearDownScript>nhinc.FileUtils.restoreConfiguration(context.findProperty("GatewayPropDir"), log);</con:tearDownScript>
    </con:testCase>
    <con:testCase failOnError="true" failTestCaseOnErrors="true" id="93d90bd5-3049-4261-9981-f58ce4469271" keepSession="false" maxResults="0" name="ICI and UDDI" searchProperties="true">
      <con:settings/>
      <con:testStep name="copy internalExchangeInfo" type="groovy" id="202f5597-f64c-4970-a06c-f948e835c961">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalExchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalExchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="copy exchangeInfo" type="groovy" id="ed0b232c-14c8-42e5-93dd-14003d4062c3">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-exchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "exchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="Region in both UDDI anad ICI" type="request" id="ad3b7349-b4f6-4879-afd6-0351f6a8a6a9">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Region in both UDDI anad ICI" id="25ec2029-4178-4a60-bb25-ad5aca409a9f">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="9c8241ef-e3b3-4618-b49c-d9657aebffc4"/>
            <con:assertion type="SOAP Fault Assertion" id="3bc1fdaf-f966-45d2-868d-e50ed1f07014"/>
            <con:assertion type="Simple Contains" id="a5e89265-e95c-455d-a220-8f606b502a37">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="0cbb8923-e24d-415c-97af-718917935e99">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="e225204b-5571-411e-9109-0f0e459d5f42">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="b9b1caae-b8c2-42dc-a369-2776b715bae0">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="HCID in both UDDI and ICI" type="request" id="c82bdaf3-3e54-4c84-aa3f-7cfbb43a3c6d">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="HCID in both UDDI and ICI" id="6a698049-2588-441f-b4e3-1a514430c26e">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>4.4</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>?</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="4cc70655-fbb2-4c05-81fb-a6cd3bfd7602"/>
            <con:assertion type="SOAP Fault Assertion" id="e630d8c7-f36f-4625-b836-dec291ced821"/>
            <con:assertion type="Simple Contains" id="d1fc572f-60eb-4b04-b0ab-a87ae58d2e2a">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:setupScript>nhinc.FileUtils.backupConfiguration(context.findProperty("GatewayPropDir"), log);</con:setupScript>
      <con:properties/>
      <con:reportParameters/>
      <con:tearDownScript>nhinc.FileUtils.restoreConfiguration(context.findProperty("GatewayPropDir"), log);</con:tearDownScript>
    </con:testCase>
    <con:properties/>
    <con:reportParameters/>
  </con:testSuite>
  <con:testSuite name="QueryByState TestSuite - Passthrough" id="ae9ad686-299e-4d86-a703-7d77912e999e">
    <con:settings/>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="UDDI file - by HCID" searchProperties="true" id="f99bc9df-4efe-4e5f-8f8b-3657db6158d9">
      <con:settings/>
      <con:testStep name="copy internalExchangeInfo" type="groovy" id="b2ab2f21-5021-45b8-b9d6-990487227614">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalExchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalExchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="copy exchangeInfo" type="groovy" id="4263f688-5e9d-4123-abe4-6ebcd4417e35">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-exchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "exchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="Single HCID" type="request" id="34d72895-36d3-4d7b-a8ce-7606c6096565">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Single HCID" id="1155aaf1-678d-4c46-af07-686ddd64c055">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>4.4</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>QueryForDocuments</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="3bd76005-6171-46c0-bfb6-b17fb6a4d1b1"/>
            <con:assertion type="SOAP Fault Assertion" id="ebcb0fed-fd96-47b7-a0f7-cf474ce43320"/>
            <con:assertion name="url match" type="XPath Match" id="c84a7c9e-c7cd-42da-9d59-5393761989f1">
              <con:configuration>
                <path>declare namespace ns6='urn:gov:hhs:fha:nhinc:common:nhinccommon';
declare namespace ns5='urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo';

//ns5:URLInfos[1]/ns6:url[1]</path>
                <content>https://localhost:8181/RespondingGateway_Query_Service/DocQueryTestHelper4.4</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:assertion type="XPath Match" id="1f547dcd-89a6-4d2f-896e-683609543b0d">
              <con:configuration>
                <path>declare namespace ns6='urn:gov:hhs:fha:nhinc:common:nhinccommon';
declare namespace ns5='urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo';

//ns5:URLInfos[1]/ns6:id[1]</path>
                <content>4.4</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Multiple HCIDs" type="request" id="e1e38150-c5cf-40de-908c-c7e8484fe4e5">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Multiple HCIDs" id="d19b543c-a327-413c-ba01-20e2d5abd8aa">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
	    <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>6.6</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>4.4</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>QueryForDocuments</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="eea0d14b-a9ab-4a62-b6c5-4a8b37c5eb81"/>
            <con:assertion type="SOAP Fault Assertion" id="b5a20e4c-d298-4065-b69b-e37f22693bc8"/>
            <con:assertion type="Simple Contains" id="e47466e5-6733-452b-b6fe-5e0d0cf27e5b">
              <con:configuration>
                <token>https://localhost:8181/RespondingGateway_Query_Service/DocQueryTestHelper6.6</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="2ed73295-fdc0-45a9-85d1-d1be0bba3551">
              <con:configuration>
                <token>https://localhost:8181/RespondingGateway_Query_Service/DocQueryTestHelper4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Single HCID ( only in UDDI )" type="request" id="02c8a1b5-7142-44a6-bd08-fc4ce3fdb37b">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Single HCID ( only in UDDI )" id="0403e1fb-c922-43b2-8be8-8deb36f2559d">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>6.6</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="ef7e918a-05dc-4a1d-8b15-833853232d9f"/>
            <con:assertion type="SOAP Fault Assertion" id="d4d0517f-d879-4e0b-9fbb-b0ad7883c46b"/>
            <con:assertion type="XPath Match" id="d92befba-3290-454a-9d27-15820c4ecd1b">
              <con:configuration>
                <path>declare namespace ns6='urn:gov:hhs:fha:nhinc:common:nhinccommon';
declare namespace ns5='urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo';

//ns5:URLInfos[1]/ns6:url[1]</path>
                <content>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery6.6</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:setupScript>nhinc.FileUtils.backupConfiguration(context.findProperty("GatewayPropDir"), log);
log.info "Before"
context.setGatewayStandard(false);
log.info "After"</con:setupScript>
      <con:properties/>
      <con:reportParameters/>
      <con:tearDownScript>nhinc.FileUtils.restoreConfiguration(context.findProperty("GatewayPropDir"), log);
context.setGatewayStandard(true);</con:tearDownScript>
    </con:testCase>
    <con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="UDDI file - by Region" searchProperties="true" id="319ed84a-cb19-4d47-bbd0-e4fb1836625d">
      <con:settings/>
      <con:testStep name="copy internalExchangeInfo" type="groovy" id="1c54ac36-312b-4eb1-9b58-68aad96fde92">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalExchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalExchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="copy exchangeInfo" type="groovy" id="c9224cc7-9537-4049-854d-d18e7860b1ab">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-exchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "exchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="Single Region" type="request" id="a23b4d92-2fe0-47ec-8eb0-1f170cd9091f">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Single Region" id="dde6cf9e-8ce9-4720-b928-929246282fe6">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="7b1195ea-fde6-4d96-b1d5-5927e9a73035"/>
            <con:assertion type="SOAP Fault Assertion" id="6d905b47-c7b3-4789-b004-8b0d0d52a07e"/>
            <con:assertion type="Simple Contains" id="8b5d553d-b562-4f6c-ab46-db2af155e8ee">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery5.5</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="50da3018-3788-4cde-ab9b-615c023403e6">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery5.5</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="41568783-71a6-4883-bbf8-ca2227d9eb07">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="5928b233-af91-4437-9cac-4533d561dc54">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Multiple Regions" type="request" id="ced57e21-2eea-4e53-a44b-f2bc81cf5a57">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Multiple Regions" id="de771912-ca0d-45a9-9143-06130d460379">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope">
   <soap:Header/>
   <soap:Body projectName="QueryByState" testCase="UDDI file - by Region">
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-FL</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="e06a4669-3ba2-490d-9c11-48f832838238"/>
            <con:assertion type="SOAP Fault Assertion" id="b738dfed-3919-4c37-98e9-a45ca50c75c5"/>
            <con:assertion type="Simple Contains" id="27f61482-e08d-4c90-b2c6-e09464865ff0">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="3792e56d-e070-487f-9bec-166b2c42ba2f">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="92aeea79-a23e-4468-bbfe-625fabba1f14">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="4607f0ae-4b52-4705-8480-1de8bb0b0d58">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="c379dd50-abe1-4727-be3f-1f7c55cf8933">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery6.6</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Multiple Regions ( one from UDDI and one from ICI )" type="request" id="212e0eb1-467c-4455-8d89-b138bbf4d219">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Multiple Regions ( one from UDDI and one from ICI )" id="cf6f128a-9861-4bd2-91cc-fa4c83ffe042">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope">
   <soap:Header/>
   <soap:Body projectName="QueryByState" testCase="UDDI file - by Region">
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-AZ</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-FL</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="95d65d07-4a8b-44ef-a3ef-199a9afc3874"/>
            <con:assertion type="SOAP Fault Assertion" id="1cdbbbfb-3ffb-4123-8085-e542fb309c55"/>
            <con:assertion type="Simple Contains" id="457619e2-f22f-42a7-9b9d-14611fe4d8b8">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="fc87f0dc-7838-44ad-b00e-b4c1b26dbfa2">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery6.6</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="f498c3ab-3c33-47fa-ac08-e54e4faf7cab">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="f4f1adec-7dd8-4145-9aff-bb16610a1eb7">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="2b38ae1e-ac0f-4d72-9ee3-967dbe2c4176">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:setupScript>nhinc.FileUtils.backupConfiguration(context.findProperty("GatewayPropDir"), log);
context.setGatewayStandard(false);</con:setupScript>
      <con:properties/>
      <con:reportParameters/>
      <con:tearDownScript>nhinc.FileUtils.restoreConfiguration(context.findProperty("GatewayPropDir"), log);
context.setGatewayStandard(true);</con:tearDownScript>
    </con:testCase>
    <con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="UDDI file - by region + HCID in the same tag" searchProperties="true" id="14474708-9758-4d99-bd1d-46b0376f8818">
      <con:settings/>
      <con:testStep name="copy internalExchangeInfo" type="groovy" id="184b1275-33e3-4719-a8f4-c9fc1f6cbc41">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalExchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalExchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="copy exchangeInfo" type="groovy" id="f5027b89-a0be-45ee-b868-fc393cc997bd">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-exchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "exchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="Region and associated HCID" type="request" id="b9de45b2-9578-47d3-82db-e5418872cb3e">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Region and associated HCID" id="2003140a-f09f-41eb-b893-38b6dee67e71">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>4.4</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="74dfc6f0-d360-45f7-a4d1-9ff3fb03d77f"/>
            <con:assertion type="SOAP Fault Assertion" id="aa0f9197-f7d4-4b42-ad3b-031285715b67"/>
            <con:assertion type="Simple Contains" id="0938353c-c0af-4e70-917a-bedbd8e6ecb4">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="858ec449-b7f4-469e-8c48-e3850360b194">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="97950391-10ba-457f-a4b8-69a52db185e9">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="58555eb6-2eda-4470-a15d-a92464a37523">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Region and non-associated HCID" type="request" id="888dc279-e915-4d54-ba1c-2b70d76dc164">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Region and non-associated HCID" id="a9b68cd7-441c-452f-baa1-56466699e6fe">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>6.6</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="5a3c2111-1c23-49c1-9c7c-b6f3fd646841"/>
            <con:assertion type="SOAP Fault Assertion" id="6e77224c-7496-4eef-aab1-4a3f96f16c51"/>
            <con:assertion type="Simple Contains" id="7b1d706c-9558-4f49-86d3-97467186e3af">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="0fbae7f9-8b46-4e45-abeb-8d2bfb35ab06">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="77c622e2-4684-4f26-ac6b-4581a2df70af">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="cd1fe2bf-d658-41e5-9238-50cac8319a4d">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:setupScript>nhinc.FileUtils.backupConfiguration(context.findProperty("GatewayPropDir"), log);
context.setGatewayStandard(false);</con:setupScript>
      <con:properties/>
      <con:reportParameters/>
      <con:tearDownScript>nhinc.FileUtils.restoreConfiguration(context.findProperty("GatewayPropDir"), log);
context.setGatewayStandard(true);</con:tearDownScript>
    </con:testCase>
    <con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="UDDI file - by region + HCID in a different tag" searchProperties="true" id="97c56787-78c9-4198-838f-1731544f61f4">
      <con:settings/>
      <con:testStep name="copy internalExchangeInfo" type="groovy" id="75d47a8b-c1c1-433d-af9f-14066a15b136">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalExchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalExchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="copy exchangeInfo" type="groovy" id="abac5f6e-10c2-475b-873e-01cdefb9558a">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-exchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "exchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="Region and associating HCID" type="request" id="ac283e3a-b56a-4574-a8b4-7a42549b6ea9">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Region and associating HCID" id="b5275795-74f8-4093-b8be-b4ad87943347">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope">
   <soap:Header/>
   <soap:Body projectName="QueryByState" testCase="UDDI file - by Region">
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>4.4</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region></urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="7d4bce1c-796c-4ad3-b13f-8d53f3b78d40"/>
            <con:assertion type="SOAP Fault Assertion" id="eb170a34-1bc8-4393-bd4d-9c7bc960afb5"/>
            <con:assertion type="Simple Contains" id="ea5535dd-0556-46fc-8343-832d953cbe46">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="6ab725b7-707e-494f-88e9-bd3bbf83e31a">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="0070f955-deff-485a-a1c9-1bd7d9f20906">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="74066fb1-c7eb-4128-b7df-eca17a73e887">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Region and non-associated HCID" type="request" id="28973558-4f62-4859-a70e-5814f3dda5c0">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Region and non-associated HCID" id="3cb5e409-d463-4589-b13a-3582b6e9acbe">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope">
   <soap:Header/>
   <soap:Body projectName="QueryByState" testCase="UDDI file - by Region">
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>6.6</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region></urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="959d5e35-eef4-46a4-b506-d61bda5b6a1f"/>
            <con:assertion type="SOAP Fault Assertion" id="2b84d349-7039-4968-89ad-b76dd445f015"/>
            <con:assertion type="Simple Contains" id="12087857-e8eb-4b01-b024-8cd4a13dea9d">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="cfc32370-21a0-4277-b12f-3417ca4f614e">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="8a773cba-ec80-499d-91e2-3b8588192a9f">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="105d7561-aadc-4cdd-a63c-6d51292ad2c3">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:setupScript>nhinc.FileUtils.backupConfiguration(context.findProperty("GatewayPropDir"), log);
context.setGatewayStandard(false);</con:setupScript>
      <con:properties/>
      <con:reportParameters/>
      <con:tearDownScript>nhinc.FileUtils.restoreConfiguration(context.findProperty("GatewayPropDir"), log);
context.setGatewayStandard(true);</con:tearDownScript>
    </con:testCase>
    <con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="internalExchangeInfo file - by HCID" searchProperties="true" id="03c42ec8-11cb-40a0-b713-f05a4ff66ebb">
      <con:settings/>
      <con:testStep name="copy internalExchangeInfo" type="groovy" id="6b6a0daa-d539-442e-96b7-73724ec8bfb5">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalExchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalExchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="copy exchangeInfo" type="groovy" id="c4ee36ee-43fe-46f1-a1e9-a99d597f65db">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-exchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "exchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="Single HCID" type="request" id="af1e777a-4999-4140-b59c-0f7ff8e9cf25">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Single HCID" id="82bba126-a2eb-45f2-9cf7-2f82d0e4d439">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>1.1</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>?</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="13007a10-fbd5-4037-8444-3a40a207e7a2"/>
            <con:assertion type="SOAP Fault Assertion" id="bfb2e54c-30dd-4376-b8b7-8bba66687afa"/>
            <con:assertion type="Simple Contains" id="973f22fd-871d-46ba-adbc-b446e3ca8554">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Multiple HCIDs" type="request" id="ecfb3f64-9b5c-4830-aa7b-0c8436ddedcf">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Multiple HCIDs" id="232d3e8c-d2a9-4dbb-9f53-0384c6ea05db">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>4.4</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>?</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>8.8</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>?</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="3140d31c-180d-43d8-8956-fcdfcd34179c"/>
            <con:assertion type="SOAP Fault Assertion" id="12f7eedc-a53d-4dc9-99aa-32d60f82e9eb"/>
            <con:assertion type="Simple Contains" id="57d26684-8a74-4e13-8850-243f42ea9375">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="a90435f4-f6b0-4b24-bb5a-3952643f25dc">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:setupScript>nhinc.FileUtils.backupConfiguration(context.findProperty("GatewayPropDir"), log);
context.setGatewayStandard(false);</con:setupScript>
      <con:properties/>
      <con:reportParameters/>
      <con:tearDownScript>nhinc.FileUtils.restoreConfiguration(context.findProperty("GatewayPropDir"), log);
context.setGatewayStandard(true);</con:tearDownScript>
    </con:testCase>
    <con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="internalExchangeInfo file - by Region" searchProperties="true" id="157fca40-2396-4827-8dda-055f1bea44ef">
      <con:settings/>
      <con:testStep name="copy internalExchangeInfo" type="groovy" id="446f7c2d-5656-41a2-b198-de82ad2c9329">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalExchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalExchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="copy exchangeInfo" type="groovy" id="827fe642-d47e-4ff4-9afa-e7028617a67f">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-exchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "exchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="Single Region" type="request" id="21aca24a-d45c-4e57-9b3a-ead77d1d734d">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Single Region" id="20e7fae4-1335-4c10-a2fc-d005a2b5a247">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-MD</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="2030c0c3-09f1-4fb3-adf5-03df607a5c6c"/>
            <con:assertion type="SOAP Fault Assertion" id="68ad7729-a311-4675-bc38-cc818dfc3af8"/>
            <con:assertion type="Simple Contains" id="bff9dc56-d16e-43e2-9645-3a5239b44479">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Multiple Regions" type="request" id="506d84a9-755a-4708-aa4f-707c66fef9fb">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Multiple Regions" id="a5cde0d3-6978-49f0-8389-18a7fd2c2414">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-AZ</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-MD</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="618f03cd-36bf-4b12-8f10-504fe9740638"/>
            <con:assertion type="SOAP Fault Assertion" id="03a265d3-7b91-4e34-aa5f-64cdd58b9807"/>
            <con:assertion type="Simple Contains" id="210fd832-6974-4b42-af0d-e2959a170822">
              <con:configuration>
                <token/>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="2db1d487-14f8-4883-9b87-d5c9e29fa1b7">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="00a2110d-f974-430c-9adb-fd2853662c33">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="c202b116-ffea-4090-a9f1-e8a3fbf1ab63">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:setupScript>nhinc.FileUtils.backupConfiguration(context.findProperty("GatewayPropDir"), log);
context.setGatewayStandard(false);</con:setupScript>
      <con:properties/>
      <con:reportParameters/>
      <con:tearDownScript>nhinc.FileUtils.restoreConfiguration(context.findProperty("GatewayPropDir"), log);
context.setGatewayStandard(true);</con:tearDownScript>
    </con:testCase>
    <con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="internalExchangeInfo file - by Region + HCID in the same tag" searchProperties="true" id="11878905-abde-4d8e-a740-d36503c02043">
      <con:settings/>
      <con:testStep name="copy internalExchangeInfo" type="groovy" id="76037c83-0cf7-4472-846d-cd8b3bef63e3">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalExchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalExchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="copy exchangeInfo" type="groovy" id="1a7dad6a-fe17-49b1-b067-1a68fa8e5b55">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-exchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "exchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="Region and associated HCID" type="request" id="b50e904c-a391-40ad-890e-43a17b7e0089">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Region and associated HCID" id="387c6a58-04a0-4f7e-b188-622d1fd1983a">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>1.1</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="80625f3e-be9d-4823-b50c-e91fdac92f99"/>
            <con:assertion type="SOAP Fault Assertion" id="f988de5c-04de-4dc5-91f0-03a282c6e2df"/>
            <con:assertion type="Simple Contains" id="5238bbea-7eff-4cd1-8e08-e5c1596e5a0e">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="9da66414-f52f-4f20-ba3b-5edff97ade89">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="90481112-6064-44b9-935d-822cf995e8ae">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="86bb3085-424d-4d39-a04e-8ec7b0c646c9">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Region and non-associated HCID" type="request" id="eb553ad1-090c-4150-a182-fdadad0a5965">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Region and non-associated HCID" id="49df37a4-81b1-4d0a-af4e-40cd66893d62">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>6.6</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="866f9dd4-c92d-4d34-80fe-71e8562d8442"/>
            <con:assertion type="SOAP Fault Assertion" id="33b05fd2-93fe-4de7-9677-837720dfa82b"/>
            <con:assertion type="Simple Contains" id="29898198-fdd9-48c8-8465-03423de80ea5">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery6.6</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="196c3219-c860-4734-8bc4-34d7e4019485">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="ed222878-e950-4580-b167-9c7cda094623">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="7dfc519c-f924-420f-b766-1ce0e44e35ae">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="d3ea2475-d7cc-4a68-a044-e914e8e4d1c7">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery5.5</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="7cfec7da-6b30-493c-99dd-cfa2bf53a8f2">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:setupScript>nhinc.FileUtils.backupConfiguration(context.findProperty("GatewayPropDir"), log);
context.setGatewayStandard(false);</con:setupScript>
      <con:properties/>
      <con:reportParameters/>
      <con:tearDownScript>nhinc.FileUtils.restoreConfiguration(context.findProperty("GatewayPropDir"), log);
context.setGatewayStandard(true);</con:tearDownScript>
    </con:testCase>
    <con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="internalExchangeInfo file - by Region + HCID in a different tag" searchProperties="true" id="ef8738b4-111c-4cb3-8529-d56f1970db60">
      <con:settings/>
      <con:testStep name="copy internalExchangeInfo" type="groovy" id="1892065e-3fe6-44a0-9079-b3998dc2088b">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalExchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalExchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="copy exchangeInfo" type="groovy" id="53ce9d64-26fc-4270-82c3-40ec7079576e">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-exchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "exchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="Region and associating HCID" type="request" id="249e569d-dd45-48d5-9694-fc510af9a6e8">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Region and associating HCID" id="e9971702-04b5-444d-acab-d3c9ad8fb58b">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>1.1</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>?</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-AZ</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="a8e683ff-9d3d-4ebf-b96e-f231bf438234"/>
            <con:assertion type="SOAP Fault Assertion" id="81e18f66-b56e-44ee-9111-4a1e19aba203"/>
            <con:assertion type="Simple Contains" id="816b11fd-2621-4b5f-85ba-46928c2557b6">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="41dafc0c-9e65-458b-aac5-ed6328261222">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="1e887403-0ac9-4404-800b-c1aa6cf02092">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="Region and non-associated HCID" type="request" id="1f3d52c2-9113-460d-9a4d-f5a50084c032">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Region and non-associated HCID" id="fabf03dd-d519-43d9-bfa9-51bb0ccb1556">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>2.2</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>?</urn1:region>
            </urn1:nhinTargetCommunity>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-AZ</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="5f5c3023-09c4-42df-babb-e2b3c18d762b"/>
            <con:assertion type="SOAP Fault Assertion" id="d6192f75-c37e-4664-afca-d92f9e57f09e"/>
            <con:assertion type="Simple Contains" id="b62910d0-3837-441e-8bc7-890e03ca4f02">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="07384938-e7e6-4dae-8406-ea54240cf04c">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="5fef1dad-8c5e-4cc7-980a-8c82c06c847f">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="2f38c0e8-f0f4-4834-b498-49e19bb9126c">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:setupScript>nhinc.FileUtils.backupConfiguration(context.findProperty("GatewayPropDir"), log);
context.setGatewayStandard(false);</con:setupScript>
      <con:properties/>
      <con:reportParameters/>
      <con:tearDownScript>nhinc.FileUtils.restoreConfiguration(context.findProperty("GatewayPropDir"), log);
context.setGatewayStandard(true);</con:tearDownScript>
    </con:testCase>
    <con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="ICI and UDDI" searchProperties="true" id="a11d7c54-b3f1-455b-ace5-858aeefb126e">
      <con:settings/>
      <con:testStep name="copy internalExchangeInfo" type="groovy" id="39a1c4df-32d6-4340-a44b-4a18384ee0f2">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-internalExchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "internalExchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="copy exchangeInfo" type="groovy" id="3894cdfb-2c04-48d8-9971-04a57762dd6b">
        <con:settings/>
        <con:config>
          <script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
//def projectPropPath = groovyUtils.projectPath
def projectPropPath = context.expand('${projectDir}')

def sourceDir = projectPropPath;
def sourceFile = "QBS-exchangeInfo.xml";
def destDir = context.findProperty("GatewayPropDir");
//def destDir = context.findProperty( "NHINGatewayConfigDir" );
def destFile = "exchangeInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.copyFile(sourceDir, sourceFile, destDir, destFile, log);</script>
        </con:config>
      </con:testStep>
      <con:testStep name="Region in both UDDI anad ICI" type="request" id="1c044eb2-474c-427b-857e-e5b1988ba6d7">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="Region in both UDDI anad ICI" id="bb04d10a-adc4-4e85-93dd-3e2777663651">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>?</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>US-VA</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="b6d635cd-9817-4aaa-8ca5-8bec41a6ec5d"/>
            <con:assertion type="SOAP Fault Assertion" id="6036dbe4-f5a5-4feb-8071-3467521bf7da"/>
            <con:assertion type="Simple Contains" id="ef153f67-f289-472e-969f-1c6bd1a85a49">
              <con:configuration>
                <token>https://localhost:8181/NhinTestHelper/NhinPatientDiscovery7.7</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="04f4340c-9033-48da-b2f7-1731a1e5d219">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="e4dc97bd-9b91-4fa8-be51-de0de7625954">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-1.1</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="a354a70e-8c54-4d79-b094-086d4abef322">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-8.8</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:testStep name="HCID in both UDDI and ICI" type="request" id="5103a332-df8d-43fd-aa45-9fa824c84a1e">
        <con:settings/>
        <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:interface>NhincComponentConnectionManagerBindingSoap</con:interface>
          <con:operation>GetEndpointURLFromNhinTargetCommunities</con:operation>
          <con:request name="HCID in both UDDI and ICI" id="ea1fe185-f09b-4d38-b2eb-717d3e2cdfc9">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:endpoint>
            <con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:connectionmanagerinfo" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soap:Header/>
   <soap:Body>
      <urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
         <urn:NhinTargetCommunities>
            <!--1 or more repetitions:-->
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
                  <urn1:description>?</urn1:description>
                  <urn1:homeCommunityId>4.4</urn1:homeCommunityId>
                  <urn1:name>?</urn1:name>
               </urn1:homeCommunity>
               <urn1:list>?</urn1:list>
               <urn1:region>?</urn1:region>
            </urn1:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
         <urn:serviceName>PatientDiscovery</urn:serviceName>
      </urn:GetEndpointURLFromNhinTargetCommunitiesRequest>
   </soap:Body>
</soap:Envelope>]]></con:request>
            <con:assertion type="SOAP Response" id="a277eee8-9b0c-43ec-b120-2987b9a05a63"/>
            <con:assertion type="SOAP Fault Assertion" id="d7c3cff6-d81c-416c-ad91-af522ed7de38"/>
            <con:assertion type="Simple Contains" id="ed01d606-fce3-4722-98f3-ba03ac6fae66">
              <con:configuration>
                <token>https://localhost:8181/NhinConnect/NhinPatientDiscovery-ICI-4.4</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep>
      <con:setupScript>nhinc.FileUtils.backupConfiguration(context.findProperty("GatewayPropDir"), log);
context.setGatewayStandard(false);</con:setupScript>
      <con:properties/>
      <con:reportParameters/>
      <con:tearDownScript>nhinc.FileUtils.restoreConfiguration(context.findProperty("GatewayPropDir"), log);
context.setGatewayStandard(true);</con:tearDownScript>
    </con:testCase>
    <con:properties/>
    <con:reportParameters/>
  </con:testSuite>
  <con:requirements/>
  <con:properties>
    <con:property>
      <con:name>DBPass</con:name>
      <con:value>nhincpass</con:value>
    </con:property>
    <con:property>
      <con:name>DBHost</con:name>
      <con:value>localhost</con:value>
    </con:property>
    <con:property>
      <con:name>Endpoint-Querybystate</con:name>
      <con:value>http://localhost:8080/CONNECTCommon/NhincComponentConnectionManager</con:value>
    </con:property>
    <con:property>
      <con:name>LocalConfigDir</con:name>
      <con:value>C:/SelfTest/EndToEndSelfTest</con:value>
    </con:property>
    <con:property>
      <con:name>DBUser</con:name>
      <con:value>nhincuser</con:value>
    </con:property>
    <con:property>
      <con:name>DBPort</con:name>
      <con:value>3306</con:value>
    </con:property>
    <con:property>
      <con:name>MPIDir</con:name>
      <con:value>C:/Sun/AppServer/domains/domain1/config</con:value>
    </con:property>
    <con:property>
      <con:name>NHINGatewayConfigDir</con:name>
      <con:value>C:/Sun/AppServer/domains/domain1/config/nhin</con:value>
    </con:property>
    <con:property>
      <con:name>GatewayPropDir</con:name>
      <con:value></con:value>
    </con:property>
    <con:property>
      <con:name>ASUsername</con:name>
      <con:value>admin</con:value>
    </con:property>
    <con:property>
      <con:name>ASPassword</con:name>
      <con:value>adminadmin</con:value>
    </con:property>
    <con:property>
      <con:name>JMXHost</con:name>
      <con:value>localhost</con:value>
    </con:property>
    <con:property>
      <con:name>JMXPort</con:name>
      <con:value>9990</con:value>
    </con:property>
  </con:properties>
  <con:afterLoadScript>def propertiesFile = new File(new File(project.path).parent, 'QueryByState-soapui-project.properties')
if (propertiesFile.exists()) {
	def props = new Properties()
	props.load(new FileReader(propertiesFile))
	props.each { key, value ->
	    project.setPropertyValue(key, value)
	}
}

com.eviware.soapui.impl.wsdl.testcase.WsdlTestRunContext.metaClass.findProperty = { propertyName ->
return delegate.getProperty(propertyName) ?:
delegate.testCase.getPropertyValue(propertyName) ?:
delegate.testCase.testSuite.getPropertyValue(propertyName) ?:
delegate.testCase.testSuite.project.getPropertyValue(propertyName) ?:
com.eviware.soapui.SoapUI.globalProperties.getPropertyValue(propertyName)
}

import javax.management.remote.JMXConnectorFactory as JmxFactory
import javax.management.remote.JMXServiceURL as JmxUrl
import javax.management.remote.*;

com.eviware.soapui.impl.wsdl.testcase.WsdlTestRunContext.metaClass.setGatewayStandard = { standard ->
  def username = delegate.findProperty("ASUsername");
  def password = delegate.findProperty("ASPassword");
  def jmxHost = delegate.findProperty("JMXHost");
  def jmxPort = delegate.findProperty("JMXPort");
  log.info "Value of the Param Name -->"+standard;
  // use jmx to set passthru mode
  def env = [
    (JMXConnector.CREDENTIALS): (String[])[username, password]
  ];
  def serverUrl = 'service:jmx:http-remoting-jmx://'+jmxHost+ ':' + jmxPort;
  log.info "Standard value-->"+standard
  def server = JmxFactory.connect(new JmxUrl(serverUrl), env);
  def config = new GroovyMBean(server.MBeanServerConnection, 'org.connectopensource.mbeans:type=Configuration');
  //set the Gateway to Standard Mode
    if (standard){
  	config.setStandardMode();
  	log.info "Inside STD"
  }
  else{
  	log.info "Inside PASS"
     config.setPassthruMode();	
  }
  server.close();
  return true;
}

com.eviware.soapui.impl.wsdl.testcase.WsdlTestRunContext.metaClass.isStandard = { serviceName, direction ->
  def username = delegate.findProperty("ASUsername");
  def password = delegate.findProperty("ASPassword");
  def jmxHost = delegate.findProperty("JMXHost");
  def jmxPort = delegate.findProperty("JMXPort");
  log.info "Value of the Param Name -->"+name;
  // use jmx to set passthru mode
  def env = [
    (JMXConnector.CREDENTIALS): (String[])[username, password]
  ];
  def serverUrl = 'service:jmx:http-remoting-jmx://'+jmxHost+ ':' + jmxPort;
   
  def server = JmxFactory.connect(new JmxUrl(serverUrl), env);
  def config = new GroovyMBean(server.MBeanServerConnection, 'org.connectopensource.mbeans:type=Configuration');
  //set the Gateway to Standard Mode
  def isStandard = config.isStandard(serviceName, direction);
  server.close();
  return isStandard;
}

com.eviware.soapui.impl.wsdl.testcase.WsdlTestRunContext.metaClass.setGatewayStandard = { standard, serviceName, direction ->
  def username = delegate.findProperty("ASUsername");
  def password = delegate.findProperty("ASPassword");
  def jmxHost = delegate.findProperty("JMXHost");
  def jmxPort = delegate.findProperty("JMXPort");
  log.info "Value of the Param Name -->"+name;
  // use jmx to set passthru mode
  def env = [
    (JMXConnector.CREDENTIALS): (String[])[username, password]
  ];
  def serverUrl = 'service:jmx:http-remoting-jmx://'+jmxHost+ ':' + jmxPort;
  log.info "Standard value-->"+standard
  def server = JmxFactory.connect(new JmxUrl(serverUrl), env);
  def config = new GroovyMBean(server.MBeanServerConnection, 'org.connectopensource.mbeans:type=Configuration');
  //set the Gateway to Standard Mode
    if (standard){
  	config.setStandardMode(serviceName, direction);
  	log.info "Inside STD"
  }
  else{
  	log.info "Inside PASS"
     config.setPassthruMode(serviceName, direction);	
  }
  server.close();
  return true;
}</con:afterLoadScript>
  <con:wssContainer/>
  <con:databaseConnectionContainer/>
  <con:oAuth2ProfileContainer/>
  <con:reporting>
    <con:reportTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:xmlTemplates/>
    <con:parameters/>
  </con:reporting>
  <con:sensitiveInformation/>
</con:soapui-project>